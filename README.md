# 🚀 茂亨贸易Odoo (Trade Odoo 17) 一键部署管理器

## 📖 项目简介

`odoo-manager.sh` 是一个专为**工贸一体化外贸企业**设计的自动化部署与管理脚本。它能在 Linux VPS 上快速部署功能完整的 **茂亨外贸专用版 Odoo (Trade Odoo 17)** 系统。此版本深度集成了外贸业务所需的**CRM、进销存、财务、邮件营销**等核心模块，并可扩展**生产管理**功能，是企业资源规划的一站式解决方案。

脚本采用 Docker 容器化技术，通过智能优化，让复杂的企业级系统部署变得简单高效。

## ✨ 核心特性与预装模块

- **📦 开箱即用的外贸解决方案**：默认包含并优化以下核心业务流模块：
    - **客户关系管理 (CRM)**：跟踪询盘、商机和客户生命周期。
    - **进销存管理**：涵盖采购、销售、多仓库库存及物流。
    - **财务核算**：应收/应付账款、总账、财务报表。
    - **邮件营销**：客户分组、营销活动追踪与效果分析。
    - **网站/电子商务**：可快速搭建产品展示与询价网站。
    - **生产管理（按需）**：支持工贸一体化企业的生产订单、物料需求计划(MRP)与工序管理。
- **🧠 智能部署**：支持**域名模式**（自动HTTPS）和**本地模式**，满足从测试到生产的全场景。
- **⚡ 性能自动调优**：根据服务器硬件，自动配置Odoo Workers、数据库缓存等参数。
- **🔒 安全加固**：自动配置防火墙、安全策略及数据库访问控制。
- **🔄 全栈管理**：提供从部署、备份、监控到日志分析的全生命周期管理。

## 📋 系统要求与配置建议

- **操作系统**：Ubuntu 20.04/22.04 LTS（推荐）
- **权限要求**：需要具有 `sudo` 权限的用户

### ⚙️ VPS 配置推荐指南
由于本系统默认集成并运行多个资源密集型模块（如CRM、库存、财务），对服务器资源有较高要求。请根据您的业务规模参考以下配置：

| 企业规模与业务特点 | 预估并发用户数 | 推荐服务器配置 | 核心考量 |
| :--- | :--- | :--- | :--- |
| **小型贸易公司** <br>（核心使用CRM、销售、简单库存） | 5 - 15 人 | **2-4核 CPU， 4-8 GB 内存， 80 GB SSD** | 保证多模块同时运行的基本流畅度，内存是关键。 |
| **中型工贸企业** <br>（全面使用进销存、财务、邮件，初步启用生产） | 15 - 30 人 | **4-8核 CPU， 8-16 GB 内存， 150 GB SSD** | 满足多部门并发操作和生产模块的资源需求，需较高CPU和内存。 |
| **大型或业务复杂企业** <br>（全模块深度使用，数据量大，集成需求高） | 30 - 60+ 人 | **8核+ CPU， 16 GB+ 内存， 200 GB+ SSD** <br>（或考虑集群方案） | 应对高并发、复杂运算（如MRP）和大数据量，确保系统响应速度。 |

**重要提示**：
1.  **并发用户数**：指任何时刻同时操作系统、进行数据交互的用户，通常为总用户数的1/3到1/5。
2.  **生产模块**：启用生产管理（MRP）会显著增加CPU和内存的消耗，尤其是在处理物料需求计划计算时。
3.  **起步建议**：如果不确定，选择**中型企业**的起始配置（4核8GB），为业务增长留出空间。云服务商通常支持弹性升级。
4.  **硬盘必选SSD**：数据库和文件系统性能至关重要，能极大提升操作响应速度。

## 🚦 快速开始

### 步骤1：获取脚本
通过SSH连接您的服务器，执行：
```bash
wget https://raw.githubusercontent.com/morhon-tech/morhon-odoo/main/odoo-manager.sh
chmod +x odoo-manager.sh
```

### 步骤2：初始化服务器环境（仅首次）
```bash
sudo ./odoo-manager.sh init
```

### 步骤3：部署您的Odoo系统
- **快速本地部署**（用于评估或内网）：
    ```bash
    sudo ./odoo-manager.sh deploy my-company-trade
    ```
    访问地址：`http://<您的服务器IP>:8069`

- **完整生产部署**（用于正式业务，推荐）：
    ```bash
    sudo ./odoo-manager.sh deploy
    ```
    在交互菜单中选择 **“域名模式”**，输入您已准备好的域名（如 `erp.yourcompany.com`），脚本将自动完成Nginx反向代理和Let‘s Encrypt **SSL证书**配置，实现`https`安全访问。

## 📖 核心管理命令

脚本支持以下常用命令进行高效管理：

```bash
# 初始化服务器环境
sudo ./odoo-manager.sh init

# 交互式完整部署
sudo ./odoo-manager.sh deploy

# 快速部署一个名为‘myerp’的实例
sudo ./odoo-manager.sh deploy myerp

# 备份所有实例数据
sudo ./odoo-manager.sh backup

# 查看运行日志
sudo ./odoo-manager.sh logs

# 显示系统资源及容器状态
sudo ./odoo-manager.sh monitor
```

## 🔧 启用生产管理模块（工贸一体化）

系统部署后，默认已安装所有模块。要启用工贸一体化核心的**生产管理**功能，请按以下步骤操作：

1.  使用管理员账户登录您的Odoo系统。
2.  进入 **“应用”** 模块。
3.  在搜索框中输入 **“制造”** 或 **“MRP”**。
4.  找到 **“制造”** 应用，点击“安装”按钮。
5.  安装完成后，顶部导航栏会出现 **“制造”** 菜单，即可开始配置物料清单（BOM）、工作中心和生产订单。

## 🛠️ 进阶配置与故障排查

- **修改配置**：所有实例配置文件位于 `/opt/您的实例名/config/` 目录下。
- **查看密码**：管理员密码在部署时自动生成，可通过以下命令查看：
    ```bash
    cat /opt/您的实例名/.env | grep ADMIN_PASSWORD
    ```
- **数据备份**：脚本已配置每日自动备份。手动备份位于 `/var/backups/odoo/`，恢复请使用 `sudo ./odoo-manager.sh restore`。
- **常见问题**：
    - **部署慢/失败**：脚本会自动切换镜像源。若持续失败，请检查服务器网络连通性。
    - **访问卡顿**：首先通过 `sudo ./odoo-manager.sh monitor` 检查服务器资源使用率。如果CPU或内存持续过高，请考虑升级配置。

## 📄 许可证与支持

本项目基于 MIT 许可证开源。

- 对于脚本的**使用问题**，可通过GitHub提交 [Issue](https://github.com/morhon-tech/morhon-odoo/issues)。
- 对于**茂亨外贸Odoo (Trade Odoo 17) 的产品功能、业务咨询或企业级定制支持**，请访问 [茂亨科技官方网站](https://www.morhon.com) 获取专业服务。

---
**免责声明**：自动化部署工具旨在简化流程。对于关键业务数据，请务必建立定期、离线的备份机制。生产环境部署前建议进行充分测试。
